# aws bedrock homeassistant boto3 makefile
## AWS Bedrock Home Assistant Integration - Key Issues & Fixes

### 1. Bedrock invoke_model() API Call Issue
**Problem**: boto3's bedrock-runtime.invoke_model() requires keyword arguments, not positional.
**Solution**: Use a lambda wrapper when calling through async_add_executor_job:
```python
# WRONG - causes "invoke_model() only accepts keyword arguments" error:
response = await self.hass.async_add_executor_job(
    self._bedrock_runtime.invoke_model,
    model_id,
    json.dumps(request_body)
)

# CORRECT - use lambda to pass keyword arguments:
response = await self.hass.async_add_executor_job(
    lambda: self._bedrock_runtime.invoke_model(
        modelId=model_id,
        body=json.dumps(request_body)
    )
)
```
Location: custom_components/bedrock_conversation/bedrock_client.py, line ~410

### 2. Makefile Line Continuation Issue
**Problem**: Shell if/else blocks in Makefile used double backslashes (\\) for line continuation.
**Solution**: Use single backslash (\) for line continuation in Makefiles:
```makefile
# WRONG - causes "end of file unexpected" error:
@if command -v gh >/dev/null 2>&1; then \\
    printf "message"; \\
else \\
    printf "other"; \\
fi

# CORRECT - single backslash for line continuation:
@if command -v gh >/dev/null 2>&1; then \
    printf "message"; \
else \
    printf "other"; \
fi
```
Location: Makefile, lines 76-81

### Project Structure
- Custom component: custom_components/bedrock_conversation/
- Key files: bedrock_client.py (AWS API calls), conversation.py (HA agent), config_flow.py (UI)
- Testing: make test, make lint, make format, make typecheck
- Release: make release (uses manifest.json version)

